flowchart TD
    subgraph "üèóÔ∏è EVENT CREATION PROCESS"
        EC1[üëë Admin Access Required] --> EC2[üìù Input Event Details]
        EC2 --> EC3{‚úÖ Validate Input}
        EC3 -->|‚ùå Name < 5 chars| EC4[‚ö†Ô∏è Error: Name too short]
        EC3 -->|‚ùå Past Date| EC5[‚ö†Ô∏è Error: Date in past]
        EC3 -->|‚ùå Capacity ‚â§ 0| EC6[‚ö†Ô∏è Error: Invalid capacity]
        EC4 --> EC2
        EC5 --> EC2
        EC6 --> EC2
        EC3 -->|‚úÖ Valid| EC7[üéØ Generate Event ID]
        EC7 --> EC8[üìÖ Create Event Object]
        EC8 --> EC9[üíæ Store in System]
        EC9 --> EC10[üéâ Success Notification]
        EC10 --> EC11[üîÑ Return to Menu]
    end
    
    subgraph "üìù REGISTRATION PROCESS"
        R1[üë§ Student/Visitor Access] --> R2[üìã Show Available Events]
        R2 --> R3[üéØ User Selects Event]
        R3 --> R4{‚úÖ Check Conditions}
        R4 -->|‚ùå Already Registered| R5[‚ö†Ô∏è Error: Duplicate registration]
        R4 -->|‚ùå Event Full| R6[‚ö†Ô∏è Error: No capacity]
        R4 -->|‚úÖ Valid| R7[‚ûï Add to Attendees]
        R5 --> R8[üîÑ Return to Menu]
        R6 --> R8
        R7 --> R9[üìä Update Capacity Info]
        R9 --> R10[üéâ Registration Success]
        R10 --> R11[üìã Show Remaining Spots]
        R11 --> R8
    end
    
    subgraph "üîç SEARCH PROCESS"
        S1[üîç Search Menu] --> S2{üìÇ Search Type}
        S2 -->|1| S3[üè∑Ô∏è Name Search]
        S2 -->|2| S4[üìç Location Search]
        S2 -->|3| S5[üìÖ Date Search]
        S2 -->|4| S6[üë§ Organizer Search]
        S2 -->|5| S7[üìä Status Filter]
        S2 -->|6| S8[üîç Advanced Search]
        
        S3 --> S9[üí≠ Apply Name Filter]
        S4 --> S10[üí≠ Apply Location Filter]
        S5 --> S11[üí≠ Apply Date Filter]
        S6 --> S12[üí≠ Apply Organizer Filter]
        S7 --> S13[üí≠ Apply Status Filter]
        S8 --> S14[üí≠ Apply Multiple Criteria]
        
        S9 --> S15[üìã Collect Results]
        S10 --> S15
        S11 --> S15
        S12 --> S15
        S13 --> S15
        S14 --> S15
        
        S15 --> S16{‚ùì Results Found?}
        S16 -->|‚ùå No| S17[‚ö†Ô∏è No Results Message]
        S16 -->|‚úÖ Yes| S18[üìã Display Results Table]
        S17 --> S19[üîÑ Return to Search]
        S18 --> S20{üéØ User Action}
        S20 -->|1| S21[üëÅÔ∏è View Details]
        S20 -->|2| S22[üìù Register from Results]
        S20 -->|3| S23[üì§ Export Results]
        S21 --> S20
        S22 --> S20
        S23 --> S20
        S20 -->|0| S19
    end
    
    subgraph "üìä STATISTICS & REPORTING"
        ST1[üëë Admin Access] --> ST2[üìà Calculate Statistics]
        ST2 --> ST3[üìä Total Events & Attendees]
        ST3 --> ST4[üèÜ Find Max/Min Attendance]
        ST4 --> ST5[üë• Group by Role]
        ST5 --> ST6[üéØ Group by Organizer]
        ST6 --> ST7[üìà Calculate Fill Rates]
        ST7 --> ST8[üìã Display Summary]
        ST8 --> ST9{üì§ Export Options}
        ST9 -->|1| ST10[üìÑ Excel Format UTF-8-BOM]
        ST9 -->|2| ST11[üìÑ WPS Format UTF-8]
        ST9 -->|3| ST12[üìÑ Both Formats]
        ST9 -->|4| ST13[üìã Detailed Attendee Report]
        ST10 --> ST14[üíæ Create CSV File]
        ST11 --> ST14
        ST12 --> ST14
        ST13 --> ST14
        ST14 --> ST15[‚úÖ Export Success]
        ST15 --> ST16[üîÑ Return to Menu]
    end
    
    subgraph "üóëÔ∏è EVENT DELETION PROCESS"
        D1[üëë Admin Access Required] --> D2[üìã Show All Events]
        D2 --> D3[üéØ Select Event to Delete]
        D3 --> D4[‚öñÔ∏è Analyze Deletion Impact]
        D4 --> D5[üìä Count Affected Attendees]
        D5 --> D6[‚ö†Ô∏è Show Impact Warnings]
        D6 --> D7[üìã List Affected Users]
        D7 --> D8{‚ùì First Confirmation}
        D8 -->|‚ùå Cancel| D9[‚ùå Deletion Cancelled]
        D8 -->|‚úÖ YES| D10{‚ùì High Impact?}
        D10 -->|‚úÖ Yes| D11[‚ö†Ô∏è Type Event Name]
        D10 -->|‚ùå No| D12[üóëÔ∏è Proceed with Deletion]
        D11 --> D13{‚úÖ Name Match?}
        D13 -->|‚ùå No| D14[‚ùå Name Mismatch]
        D13 -->|‚úÖ Yes| D12
        D14 --> D9
        D12 --> D15[üîÑ Remove Attendees]
        D15 --> D16[üóëÔ∏è Delete Event]
        D16 --> D17[üíæ Auto-save Data]
        D17 --> D18[‚úÖ Deletion Complete]
        D18 --> D19[üìß Suggest Notifications]
        D19 --> D20[üîÑ Return to Menu]
        D9 --> D20
    end
    
    %% Styling
    classDef processStart fill:#00b894,stroke:#00a085,stroke-width:2px,color:#fff
    classDef validation fill:#fdcb6e,stroke:#e17055,stroke-width:2px,color:#000
    classDef error fill:#ff6b6b,stroke:#d63031,stroke-width:2px,color:#fff
    classDef success fill:#55a3ff,stroke:#0984e3,stroke-width:2px,color:#fff
    classDef decision fill:#a29bfe,stroke:#6c5ce7,stroke-width:2px,color:#fff
    classDef action fill:#fd79a8,stroke:#e84393,stroke-width:2px,color:#fff
    
    class EC1,R1,S1,ST1,D1 processStart
    class EC3,R4,S16,D8,D10,D13 decision
    class EC4,EC5,EC6,R5,R6,S17,D9,D14 error
    class EC10,R10,ST15,D18 success
    class EC2,EC7,EC8,R7,S9,S10,S11,S12,S13,S14,ST2,ST3,ST4,ST5,ST6,ST7,D4,D5,D12,D15,D16 action
    class EC3,R4,S2,S20,ST9,D8,D10,D11,D13 validation